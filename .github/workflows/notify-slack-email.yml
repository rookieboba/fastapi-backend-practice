name: "Notify Slack & Email (Sungbin Park FastAPI)"

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout ì½”ë“œ
        uses: actions/checkout@v3

      - name: Slackìœ¼ë¡œ ì•Œë¦¼ ë³´ë‚´ê¸°
        uses: slackapi/slack-github-action@v1.23.0
        with:
          slack-webhook-url: ${{ secrets.SLACK_WEBHOOK_URL }}
          text: |
            ğŸš€ *Sungbin Park â€“ FastAPI ê°œë°œ íŒŒì´í”„ë¼ì¸ ì•Œë¦¼*
            â€¢ ë¦¬í¬ì§€í† ë¦¬: `${{ github.repository }}`
            â€¢ ë¸Œëœì¹˜: `${{ github.ref_name }}`
            â€¢ ì»¤ë°‹: `${{ github.sha }}`
            â€¢ ì‘ì„±ì: `${{ github.actor }}`

      - name: Emailë¡œ ì•Œë¦¼ ë³´ë‚´ê¸°
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: ${{ secrets.SMTP_SERVER }}
          server_port:    ${{ secrets.SMTP_PORT }}
          username:       ${{ secrets.SMTP_USERNAME }}
          password:       ${{ secrets.SMTP_PASSWORD }}
          to:             terranbin@gmail.com
          from:           'GitHub Actions <${{ secrets.SMTP_USERNAME }}>'
          subject:        '[FastAPI][Sungbin Park] ì»¤ë°‹ ì•Œë¦¼: ${{ github.repository }}'
          body: |
            ì•ˆë…•í•˜ì„¸ìš”, Sungbin Parkì…ë‹ˆë‹¤.

            FastAPI ê°œë°œ íŒŒì´í”„ë¼ì¸ì—ì„œ ì»¤ë°‹ì´ ìˆì—ˆìŠµë‹ˆë‹¤.

            â€¢ ë¦¬í¬ì§€í† ë¦¬: ${{ github.repository }}
            â€¢ ë¸Œëœì¹˜:      ${{ github.ref_name }}
            â€¢ ì»¤ë°‹ ë©”ì‹œì§€: ${{ github.event.head_commit.message }}
            â€¢ ì»¤ë°‹ SHA:   ${{ github.sha }}
            â€¢ ì‹¤í–‰ì:      ${{ github.actor }}

            ê°ì‚¬í•©ë‹ˆë‹¤.
